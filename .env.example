# PDF/A Service Configuration
# Copy this file to .env and fill in your values

# ============================================================================
# Authentication (Optional)
# ============================================================================
# Enable or disable Google OAuth authentication
# Set to 'true' to enable authentication, 'false' to disable (default: false)
PDFA_ENABLE_AUTH=false

# Google OAuth 2.0 Configuration
# Required when PDFA_ENABLE_AUTH=true
# Get these from: https://console.cloud.google.com/apis/credentials
GOOGLE_CLIENT_ID=your-client-id.apps.googleusercontent.com
GOOGLE_CLIENT_SECRET=your-client-secret

# JWT Configuration
# Required when PDFA_ENABLE_AUTH=true
# Generate a secure random key with: openssl rand -hex 32
JWT_SECRET_KEY=your-secret-key-minimum-32-characters-long
JWT_ALGORITHM=HS256
JWT_EXPIRY_HOURS=24

# OAuth Redirect URI
# Must match the redirect URI configured in Google Cloud Console
# For local development: http://localhost:8000/auth/callback
# For production: https://yourdomain.com/auth/callback
REDIRECT_URI=http://localhost:8000/auth/callback

# Default User Configuration (Used when AUTH_ENABLED=false)
# These values are used to create a local default user when authentication is disabled
# This allows features like job history to work even without OAuth
DEFAULT_USER_ID=local-default
DEFAULT_USER_EMAIL=local@localhost
DEFAULT_USER_NAME=Local User

# ============================================================================
# Service Configuration (Optional)
# ============================================================================
# Server host and port
# HOST=0.0.0.0
# PORT=8000

# Log level: DEBUG, INFO, WARNING, ERROR, CRITICAL
# LOG_LEVEL=INFO

# ============================================================================
# MongoDB Configuration (Required)
# ============================================================================
# MongoDB connection URI
# Format: mongodb://username:password@host:port/database?authSource=admin
# For Docker Compose: Use 'mongodb' as hostname (service name)
# For local development: Use 'localhost'
# For MongoDB Atlas: Use connection string from Atlas dashboard
MONGODB_URI=mongodb://pdfa_user:change_this_password@mongodb:27017/pdfa_service?authSource=admin

# Database name (default: pdfa_service)
MONGODB_DATABASE=pdfa_service

# Job history retention in days (default: 90)
# Jobs older than this will be automatically deleted by MongoDB TTL index
MONGODB_JOB_TTL_DAYS=90

# MongoDB Authentication
# These are used by docker-compose to initialize MongoDB
# IMPORTANT: Change these passwords in production!
MONGO_ROOT_PASSWORD=change_this_admin_password
PDFA_DB_PASSWORD=change_this_password

# ============================================================================
# Accessibility Camera Configuration (Optional)
# ============================================================================
# These settings control the audio-guided camera assistance for blind and
# visually impaired users. All settings are optional with sensible defaults.

# --- Debug Settings ---
# Enable verbose debug logging in browser console (default: false)
# Set to 'true' for troubleshooting camera detection issues
A11Y_CAMERA_DEBUG=false

# --- Edge Detection Hysteresis ---
# Hysteresis prevents flickering between "detected" and "lost" states
# Upper threshold: Confidence must exceed this to transition to "detected" (0.3-0.7, default: 0.45)
A11Y_CAMERA_HYSTERESIS_UPPER=0.45
# Lower threshold: Confidence must fall below this to transition to "lost" (0.2-0.6, default: 0.35)
A11Y_CAMERA_HYSTERESIS_LOWER=0.35

# --- Confidence Calculation ---
# These control what document sizes are accepted
# Minimum document area as fraction of frame (0.05-0.20, default: 0.10)
# Lower values allow smaller/farther documents
A11Y_CAMERA_CONFIDENCE_MIN_AREA=0.10
# Maximum document area as fraction of frame (0.70-0.95, default: 0.90)
# Higher values allow closer documents
A11Y_CAMERA_CONFIDENCE_MAX_AREA=0.90
# Optimal document area for peak confidence (0.30-0.50, default: 0.40)
# Documents at this size get confidence of 1.0
A11Y_CAMERA_CONFIDENCE_PEAK_AREA=0.40

# --- Auto-Capture Settings ---
# Number of consecutive stable frames required before auto-capture (5-20, default: 10)
# Higher = more stable but slower. At 10 FPS, 10 frames = ~1 second
A11Y_CAMERA_STABLE_FRAMES=10
# Countdown duration in seconds before capture (1-5, default: 2)
# Gives user time to hold steady
A11Y_CAMERA_COUNTDOWN_SECONDS=2

# --- Performance Settings ---
# Frame analysis rate in Hz (5-30, default: 10)
# Higher = more responsive but more CPU usage
A11Y_CAMERA_ANALYSIS_FPS=10

# --- Image Quality Settings ---
# JPEG quality for normal captures (0.70-0.95, default: 0.85)
A11Y_CAMERA_JPEG_QUALITY_NORMAL=0.85
# JPEG quality for auto-cropped images (0.80-1.0, default: 0.90)
# Higher quality for perspective-corrected images
A11Y_CAMERA_JPEG_QUALITY_AUTOCROP=0.90

# --- Audio Feedback Tones ---
# Success tone (edges detected)
A11Y_CAMERA_TONE_SUCCESS_FREQ=880        # Frequency in Hz (400-1200, default: 880 = A5)
A11Y_CAMERA_TONE_SUCCESS_DURATION=200    # Duration in ms (100-500, default: 200)
# Warning tone (edges lost)
A11Y_CAMERA_TONE_WARNING_FREQ=440        # Frequency in Hz (200-800, default: 440 = A4)
A11Y_CAMERA_TONE_WARNING_DURATION=150    # Duration in ms (100-400, default: 150)
# Countdown beep
A11Y_CAMERA_TONE_COUNTDOWN_FREQ=523      # Frequency in Hz (400-800, default: 523 = C5)
A11Y_CAMERA_TONE_COUNTDOWN_DURATION=100  # Duration in ms (50-200, default: 100)

# --- Voice Announcements ---
# Minimum time between TTS announcements in ms (1000-5000, default: 2000)
# Prevents announcement spam
A11Y_CAMERA_ANNOUNCEMENT_THROTTLE=2000

# --- Edge Detection ---
# Margin in pixels from canvas edge to consider "edge not visible" (10-50, default: 20)
# Lower = stricter centering requirement
A11Y_CAMERA_EDGE_MARGIN=20
